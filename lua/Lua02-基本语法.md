# Lua02-基本语法

###  标示符命名规则

* Lua 标示符用于定义一个变量，函数获取其他用户定义的项。
* 标示符以一个字母 A 到 Z 或 a 到 z 或下划线 _ 开头后加上0个或多个字母，下划线，数字（0到9）。

* 最好不要使用下划线加大写字母的标示符，因为Lua的保留字也是这样的。

* Lua 不允许使用特殊字符如 @, $, 和 % 来定义标示符。 Lua 是一个区分大小写的编程语言。以下列出了一些正确的标示符：

```lua
mohd         zara      abc     move_name    a_123
myname50     _temp     j       a23b9        retVal
```

### Lua的关键字

* Lua 的保留关键字不能作为常量或变量或其他用户自定义标示符： 

```lua
and	    break	do	 else
elseif	end	    false	 for
function	if	in	local
nil 	not		or		repeat
return	then	true	until
while			
```

*  一般约定，以下划线开头连接一串大写字母的名字（比如 _VERSION）被保留用于 Lua 内部全局变量。 

### Lua注释

* 单行注释：两个减号是单行注释。

`--`

* 多行注释

  ```lua
  --[[
  多行
  注释
  --]]
  
  --[[
  多行
  注释
  ]]
  
  ---[[
  非多行
  注释
  --]]
  
  --[===[
  自定义多行注释
  任意=数量，前后一致
  ]===]
  ```

### Lua变量

* 变量在使用前，必须在代码中进行声明，即创建该变量。编译程序执行代码之前编译器需要知道如何给语句变量开辟存储区，用于存储变量的值。

* Lua 变量有三种类型：`全局变量`、`局部变量`、`表中的域`。

* 函数外的变量默认为全局变量，除非用 local 显示声明。函数内变量与函数的参数默认为局部变量。

* 局部变量的作用域为从声明位置开始到所在语句块结束（或者是直到下一个同名局部变量的声明）。

* 变量的默认值均为 nil。

#### Lua全局变量

* 在默认情况下，变量总是认为是全局的。

* 全局变量不需要声明，给一个变量赋值后即创建了这个全局变量，访问一个没有初始化的全局变量也不会出错，只不过得到的结果是：nil。

```lua
# lua
Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio (double int32)
> print(a)
nil
> b=10
> print(b)
10
> 
```

* 删除一个全局变量，只需要将变量赋值为nil。 

```lua
> b=nil
> print(b)
nil
> 
```

* 这样变量b就好像从没被使用过一样。换句话说, 当且仅当一个变量不等于nil时，这个变量即存在。 

- **Lua语言不区分未初始化变量和被赋值为nil的变量**。因为其两者最终丢回回收该变量占用的内存。

#### Lua局部变量

- 与全局变量不一样， **局部变量的生效范围仅限于声明它的代码块** （一个代码块是一个控制结构的主题，或是一个函数的主题，或是一个代码段(即变量被声明时所在的文件或字符串)）。
-  **局部变量会覆盖全局变量**
- **例如：**

```lua
-- test.lua 文件脚本
a = 5               -- 全局变量
local b = 5         -- 局部变量

function joke()
    c = 5           -- 全局变量
    local d = 6     -- 局部变量
end

joke()
print(c,d)          --> 5 nil

do 
    local a = 6     -- 局部变量
    b = 6           -- 全局变量
    print(a,b);     --> 6 6
end

print(a,b)      --> 5 6
```

### 赋值语句

* 赋值是改变一个变量的值和改变表域的最基本的方法。 

```lua
a = "hello" .. "world"
t.n = t.n + 1
```

* Lua可以对多个变量同时赋值，变量列表和值列表的各个元素用逗号分开，赋值语句右边的值会依次赋给左边的变量。 

```lua
a, b = 10, 2*x       -->       a=10; b=2*x
```

* 遇到赋值语句Lua会先计算右边所有的值然后再执行赋值操作，所以我们可以这样进行交换变量的值：

```lua
x, y = y, x                     -- swap 'x' for 'y'
a[i], a[j] = a[j], a[i]         -- swap 'a[i]' for 'a[j]'
```

* 当变量个数和值的个数不一致时，Lua会一直以变量个数为基础采取以下策略：

  * 变量个数 > 值的个数             按变量个数补足nil
  *  变量个数 < 值的个数             多余的值会被忽略 

  例如：

```lua
a, b, c = 0, 1
print(a,b,c)             --> 0   1   nil
 
a, b = a+1, b+1, b+2     -- value of b+2 is ignored
print(a,b)               --> 1   2
 
a, b, c = 0
print(a,b,c)             --> 0   nil   nil
```

*  注意：如果要对多个变量赋值必须依次对每个变量赋值。 

```lua
a, b, c = 0, 0, 0
print(a,b,c)             --> 0   0   0
```

* 多值赋值经常用来交换变量，或将函数调用返回给变量：

```
a, b = f()
```

* f()返回两个值，第一个赋给a，第二个赋给b。

* 应该尽可能的使用局部变量，有两个好处：

	- 避免命名冲突。
	- 访问局部变量的速度比全局变量更快。
